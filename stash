# Stash Configuration File - Automatic Node Selection & Empty Subscription URL
# Update Interval: Daily (86400 seconds)

# General Settings
general:
  loglevel: info
  # Mode: rule (Rule-based routing), global (Global proxy), direct (Global direct)
  mode: rule
  # Enable TUN interface for enhanced compatibility (Requires Stash 2.x+)
  # tun-interface: true

# DNS Settings
dns:
  enabled: true
  ipv6: false
  # Use Fake-IP for better compatibility with certain apps/services
  enhanced-mode: fake-ip
  # Fallback DNS servers if upstream fails
  fallback:
    - 119.29.29.29 # DNSPod
    - 223.5.5.5    # AliDNS
    - 1.1.1.1      # Cloudflare DNS
    - 8.8.8.8      # Google DNS
  # Default DNS servers
  nameserver:
    - 223.5.5.5
    - 119.29.29.29
    - 114.114.114.114 # 114DNS

# Proxy Providers (Your Subscription)
proxy-providers:
  origin: # Name for your subscription provider
    type: http
    # !!! åœ¨è¿™é‡Œå¡«å…¥ä½ çš„ Stash è®¢é˜…é“¾æ¥ !!!
    # !!! Paste your Stash subscription URL here !!!
    url: ""
    # Path to store the downloaded proxy list
    path: ./providers/origin.yaml
    # Health check URL for nodes from this provider
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 600 # Check every 10 minutes
    # Update interval: 86400 seconds = 24 hours
    interval: 86400

# Rule Providers (From your .ini template)
# (Rule providers remain the same as before)
rule-providers:
  AI1:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/AI.list"
    path: ./ruleset/AI1.list
    interval: 86400
  AI2:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/AI2.list"
    path: ./ruleset/AI2.list
    interval: 86400
  GitHub:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/GitHub/GitHub.list"
    path: ./ruleset/GitHub.list
    interval: 86400
  TikTok:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/TikTok/TikTok.list"
    path: ./ruleset/TikTok.list
    interval: 86400
  Telegram:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.list"
    path: ./ruleset/Telegram.list
    interval: 86400
  Streaming_YouTube_Lian:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/YouTube.list"
    path: ./ruleset/Streaming_YouTube_Lian.list
    interval: 86400
  Streaming_YouTube_BM:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/YouTube/YouTube.list"
    path: ./ruleset/Streaming_YouTube_BM.list
    interval: 86400
  Streaming_HBO:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/HBO/HBO.list"
    path: ./ruleset/Streaming_HBO.list
    interval: 86400
  Streaming_Disney:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Disney/Disney.list"
    path: ./ruleset/Streaming_Disney.list
    interval: 86400
  Streaming_Netflix:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Netflix/Netflix.list"
    path: ./ruleset/Streaming_Netflix.list
    interval: 86400
  Streaming_Spotify:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Spotify/Spotify.list"
    path: ./ruleset/Streaming_Spotify.list
    interval: 86400
  Streaming_Sping:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/1664666655/clash/refs/heads/main/list/sping.list"
    path: ./ruleset/Streaming_Sping.list
    interval: 86400
  Overseas_Check:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Check.list"
    path: ./ruleset/Overseas_Check.list
    interval: 86400
  Overseas_Proxy:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Proxy.list"
    path: ./ruleset/Overseas_Proxy.list
    interval: 86400
  Overseas_Global:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Global/Global.list"
    path: ./ruleset/Overseas_Global.list
    interval: 86400

# Proxy Groups
proxy-groups:
  # --- 1. Policy Groups (Select type, define routing behavior) ---
  # These groups determine which Node Selection Group to use based on rules.
  - name: ğŸ‘½ AI1
    type: select
    proxies:
      - DIRECT # Allow direct connection
      - æ‰€æœ‰-è‡ªåŠ¨ # Use the url-test group
      - æ¸¯å°æ—¥æ–°éŸ©-è‡ªåŠ¨
      - å°æ—¥æ–°éŸ©-è‡ªåŠ¨
      - é¦™æ¸¯-è‡ªåŠ¨
      - å°æ¹¾-è‡ªåŠ¨
      - æ—¥æœ¬-è‡ªåŠ¨
      - æ–°åŠ å¡-è‡ªåŠ¨
      - éŸ©å›½-è‡ªåŠ¨
      - ç¾å›½-è‡ªåŠ¨
      - å…¶ä»–-è‡ªåŠ¨
      - REJECT # Block connection

  - name: ğŸ‘½ AI2
    type: select
    proxies:
      - DIRECT
      - æ‰€æœ‰-è‡ªåŠ¨
      - æ¸¯å°æ—¥æ–°éŸ©-è‡ªåŠ¨
      - å°æ—¥æ–°éŸ©-è‡ªåŠ¨
      - é¦™æ¸¯-è‡ªåŠ¨
      - å°æ¹¾-è‡ªåŠ¨
      - æ—¥æœ¬-è‡ªåŠ¨
      - æ–°åŠ å¡-è‡ªåŠ¨
      - éŸ©å›½-è‡ªåŠ¨
      - ç¾å›½-è‡ªåŠ¨
      - å…¶ä»–-è‡ªåŠ¨
      - REJECT

  - name: ğŸ“˜ GitHub
    type: select
    proxies:
      - DIRECT
      - æ‰€æœ‰-è‡ªåŠ¨
      - æ¸¯å°æ—¥æ–°éŸ©-è‡ªåŠ¨
      - å°æ—¥æ–°éŸ©-è‡ªåŠ¨
      - é¦™æ¸¯-è‡ªåŠ¨
      - å°æ¹¾-è‡ªåŠ¨
      - æ—¥æœ¬-è‡ªåŠ¨
      - æ–°åŠ å¡-è‡ªåŠ¨
      - éŸ©å›½-è‡ªåŠ¨
      - ç¾å›½-è‡ªåŠ¨
      - å…¶ä»–-è‡ªåŠ¨
      - REJECT

  - name: ğŸ‘¯â€â™‚ï¸ TikTok
    type: select
    proxies:
      # TikTok often requires non-local IP, so DIRECT might not work well. Consider removing it.
      # - DIRECT
      - æ‰€æœ‰-è‡ªåŠ¨
      - æ¸¯å°æ—¥æ–°éŸ©-è‡ªåŠ¨
      - å°æ—¥æ–°éŸ©-è‡ªåŠ¨
      - é¦™æ¸¯-è‡ªåŠ¨
      - å°æ¹¾-è‡ªåŠ¨
      - æ—¥æœ¬-è‡ªåŠ¨
      - æ–°åŠ å¡-è‡ªåŠ¨
      - éŸ©å›½-è‡ªåŠ¨
      - ç¾å›½-è‡ªåŠ¨
      - å…¶ä»–-è‡ªåŠ¨
      - REJECT

  - name: ğŸ™‹ Telegram
    type: select
    proxies:
      - DIRECT
      - æ‰€æœ‰-è‡ªåŠ¨
      - æ¸¯å°æ—¥æ–°éŸ©-è‡ªåŠ¨
      - å°æ—¥æ–°éŸ©-è‡ªåŠ¨
      - é¦™æ¸¯-è‡ªåŠ¨
      - å°æ¹¾-è‡ªåŠ¨
      - æ—¥æœ¬-è‡ªåŠ¨
      - æ–°åŠ å¡-è‡ªåŠ¨
      - éŸ©å›½-è‡ªåŠ¨
      - ç¾å›½-è‡ªåŠ¨
      - å…¶ä»–-è‡ªåŠ¨
      - REJECT

  - name: ğŸ“€ æµåª’ä½“
    type: select
    proxies:
      - DIRECT
      - æ‰€æœ‰-è‡ªåŠ¨
      - ç«çƒ§é¦™æ¸¯-è‡ªåŠ¨ # Specific group for streaming
      - æ¸¯å°æ—¥æ–°éŸ©-è‡ªåŠ¨
      - å°æ—¥æ–°éŸ©-è‡ªåŠ¨
      - é¦™æ¸¯-è‡ªåŠ¨
      - å°æ¹¾-è‡ªåŠ¨
      - æ—¥æœ¬-è‡ªåŠ¨
      - æ–°åŠ å¡-è‡ªåŠ¨
      - éŸ©å›½-è‡ªåŠ¨
      - ç¾å›½-è‡ªåŠ¨
      - å…¶ä»–-è‡ªåŠ¨
      - REJECT

  - name: ğŸŒ å›½å¤–
    type: select
    proxies:
      # Typically, overseas traffic goes through proxy, DIRECT might be less useful here.
      # - DIRECT
      - æ‰€æœ‰-è‡ªåŠ¨
      - æ¸¯å°æ—¥æ–°éŸ©-è‡ªåŠ¨
      - ç«çƒ§å°æ¹¾-è‡ªåŠ¨ # Specific group
      - å°æ—¥æ–°éŸ©-è‡ªåŠ¨
      - é¦™æ¸¯-è‡ªåŠ¨
      - å°æ¹¾-è‡ªåŠ¨
      - æ—¥æœ¬-è‡ªåŠ¨
      - æ–°åŠ å¡-è‡ªåŠ¨
      - éŸ©å›½-è‡ªåŠ¨
      - ç¾å›½-è‡ªåŠ¨
      - å…¶ä»–-è‡ªåŠ¨
      # Consider adding REJECT if needed, or let it fall through to MATCH

  - name: â¡ï¸ å›½å†…
    type: select
    proxies:
      - DIRECT # Domestic traffic usually goes direct
      - æ‰€æœ‰-è‡ªåŠ¨ # Fallback options if DIRECT fails or specific routing needed
      - æ¸¯å°æ—¥æ–°éŸ©-è‡ªåŠ¨
      - å°æ—¥æ–°éŸ©-è‡ªåŠ¨
      - é¦™æ¸¯-è‡ªåŠ¨
      - å°æ¹¾-è‡ªåŠ¨
      - æ—¥æœ¬-è‡ªåŠ¨
      - æ–°åŠ å¡-è‡ªåŠ¨
      - éŸ©å›½-è‡ªåŠ¨
      - ç¾å›½-è‡ªåŠ¨
      - å…¶ä»–-è‡ªåŠ¨
      # REJECT might not be needed here, default should be DIRECT

  # --- 2. Node Selection Groups (url-test type, automatic selection) ---
  # These groups perform speed tests and automatically select the fastest node.
  - name: æ‰€æœ‰-è‡ªåŠ¨
    type: url-test
    use: [origin]
    url: http://www.gstatic.com/generate_204
    interval: 60
    tolerance: 150

  - name: æ¸¯å°æ—¥æ–°éŸ©-è‡ªåŠ¨
    type: url-test
    use: [origin]
    filter: '(å¹¿æ¸¯|å¹¿å°|å¹¿æ—¥|å¹¿æ–°|å¹¿éŸ©|å¹¿ç¾|é¦™æ¸¯|HK|Hong Kong|ğŸ‡­ğŸ‡°|HongKong|å°æ¹¾|TW|Tai Wan|ğŸ‡¹ğŸ‡¼|ğŸ‡¨ğŸ‡³|TaiWan|Taiwan|æ—¥æœ¬|JP|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|æ²ªæ—¥|æ·±æ—¥|ğŸ‡¯ğŸ‡µ|Japan|æ–°åŠ å¡|SG|å¡|ç‹®åŸ|ğŸ‡¸ğŸ‡¬|Singapore|éŸ©å›½|KR|é¦–å°”|æ˜¥å·|ğŸ‡°ğŸ‡·|Korea)'
    url: http://www.gstatic.com/generate_204
    interval: 60
    tolerance: 150

  - name: å°æ—¥æ–°éŸ©-è‡ªåŠ¨
    type: url-test
    use: [origin]
    filter: '(å¹¿å°|å¹¿æ—¥|å¹¿æ–°|å¹¿éŸ©|å¹¿ç¾|å°æ¹¾|TW|Tai Wan|ğŸ‡¹ğŸ‡¼|ğŸ‡¨ğŸ‡³|TaiWan|Taiwan|æ—¥æœ¬|JP|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|æ²ªæ—¥|æ·±æ—¥|ğŸ‡¯ğŸ‡µ|Japan|æ–°åŠ å¡|SG|å¡|ç‹®åŸ|ğŸ‡¸ğŸ‡¬|Singapore|éŸ©å›½|KR|é¦–å°”|æ˜¥å·|ğŸ‡°ğŸ‡·|Korea)'
    url: http://www.gstatic.com/generate_204
    interval: 60
    tolerance: 150

  - name: ç«çƒ§é¦™æ¸¯-è‡ªåŠ¨
    type: url-test
    use: [origin]
    filter: 'ç«çƒ§ \| é¦™æ¸¯ 0[1-8]'
    url: http://www.gstatic.com/generate_204
    interval: 60
    tolerance: 150

  - name: ç«çƒ§å°æ¹¾-è‡ªåŠ¨
    type: url-test
    use: [origin]
    filter: 'ç«çƒ§ \| å°æ¹¾ 0[1-5]'
    url: http://www.gstatic.com/generate_204
    interval: 60
    tolerance: 150

  - name: é¦™æ¸¯-è‡ªåŠ¨
    type: url-test
    use: [origin]
    filter: '(å¹¿æ¸¯|é¦™æ¸¯|HK|Hong Kong|ğŸ‡­ğŸ‡°|HongKong)'
    url: http://www.gstatic.com/generate_204
    interval: 60
    tolerance: 150

  - name: å°æ¹¾-è‡ªåŠ¨
    type: url-test
    use: [origin]
    filter: '(å¹¿å°|å°æ¹¾|å°ç£|TW|Tai Wan|ğŸ‡¹ğŸ‡¼|ğŸ‡¨ğŸ‡³|TaiWan|Taiwan)'
    url: http://www.gstatic.com/generate_204
    interval: 60
    tolerance: 150

  - name: æ—¥æœ¬-è‡ªåŠ¨
    type: url-test
    use: [origin]
    filter: '(å¹¿æ—¥|æ—¥æœ¬|JP|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|æ²ªæ—¥|æ·±æ—¥|ğŸ‡¯ğŸ‡µ|Japan)'
    url: http://www.gstatic.com/generate_204
    interval: 60
    tolerance: 150

  - name: æ–°åŠ å¡-è‡ªåŠ¨
    type: url-test
    use: [origin]
    filter: '(å¹¿æ–°|æ–°åŠ å¡|SG|å¡|ç‹®åŸ|ğŸ‡¸ğŸ‡¬|Singapore)'
    url: http://www.gstatic.com/generate_204
    interval: 60
    tolerance: 150

  - name: éŸ©å›½-è‡ªåŠ¨
    type: url-test
    use: [origin]
    filter: '(å¹¿éŸ©|éŸ©å›½|éŸ“åœ‹|KR|é¦–å°”|æ˜¥å·|ğŸ‡°ğŸ‡·|Korea)'
    url: http://www.gstatic.com/generate_204
    interval: 60
    tolerance: 150

  - name: ç¾å›½-è‡ªåŠ¨
    type: url-test
    use: [origin]
    filter: '(å¹¿ç¾|ç¾|US|çº½çº¦|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯|æ´›æ‰|åœ£ä½•å¡|åœ£å…‹æ‹‰|è¥¿é›…|èŠåŠ |ğŸ‡ºğŸ‡¸|United States)'
    url: http://www.gstatic.com/generate_204
    interval: 60
    tolerance: 150

  - name: å…¶ä»–-è‡ªåŠ¨
    type: url-test
    use: [origin]
    filter: '(æ³¢|æŸ¬|å°¼|ä¹Ÿ|å…‹|æ¯”|å°”|ç«‹|å†°|ç§˜|è€³|åˆ©|åŸƒ|å¸Œ|å­Ÿ|èŠ¬|æ„›|æ¾³|è‹±|å¾·|å—|æ„|æ³•|æ‹¿|å¢¨|å°|è¶Š|ä¿„|ç‘|æ™º|è·|æ¯”|å·´|æ²™|ç­|æ³°|å¾·|çƒ|ä»¥|Australia|Konghwaguk)'
    url: http://www.gstatic.com/generate_204
    interval: 60
    tolerance: 150

# Rules Section
# (Rules remain the same, pointing to the top-level policy groups)
rules:
  # --- Custom Rules based on Rule Providers ---
  - RULE-SET,AI1,ğŸ‘½ AI1
  - RULE-SET,AI2,ğŸ‘½ AI2
  - RULE-SET,GitHub,ğŸ“˜ GitHub
  - RULE-SET,TikTok,ğŸ‘¯â€â™‚ï¸ TikTok
  - RULE-SET,Telegram,ğŸ™‹ Telegram
  # Streaming Rules (Map all streaming providers to the 'æµåª’ä½“' policy group)
  - RULE-SET,Streaming_YouTube_Lian,ğŸ“€ æµåª’ä½“
  - RULE-SET,Streaming_YouTube_BM,ğŸ“€ æµåª’ä½“
  - RULE-SET,Streaming_HBO,ğŸ“€ æµåª’ä½“
  - RULE-SET,Streaming_Disney,ğŸ“€ æµåª’ä½“
  - RULE-SET,Streaming_Netflix,ğŸ“€ æµåª’ä½“
  - RULE-SET,Streaming_Spotify,ğŸ“€ æµåª’ä½“
  - RULE-SET,Streaming_Sping,ğŸ“€ æµåª’ä½“
  # Overseas Rules (Map all overseas providers to the 'å›½å¤–' policy group)
  - RULE-SET,Overseas_Check,ğŸŒ å›½å¤–
  - RULE-SET,Overseas_Proxy,ğŸŒ å›½å¤–
  - RULE-SET,Overseas_Global,ğŸŒ å›½å¤–

  # --- Standard Rules ---
  # Local Network / Private IPs -> DIRECT
  - IP-CIDR,192.168.0.0/16,DIRECT
  - IP-CIDR,10.0.0.0/8,DIRECT
  - IP-CIDR,172.16.0.0/12,DIRECT
  - IP-CIDR,127.0.0.1/8,DIRECT
  - IP-CIDR,100.64.0.0/10,DIRECT # CGNAT addresses

  # China Mainland IPs -> Domestic Policy Group (â¡ï¸ å›½å†…)
  - GEOIP,CN,â¡ï¸ å›½å†…

  # Final Rule: Match anything else -> Overseas Policy Group (ğŸŒ å›½å¤–)
  # This acts as the default for traffic not matching any rule above.
  - MATCH,ğŸŒ å›½å¤–
