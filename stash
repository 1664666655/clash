# Stash 設定檔片段 - 修正 FINAL 規則錯誤

# 1. Proxy Providers (節點提供者)
proxy-providers:
  SubscriptionNodes:
    type: http
    # 將下方的 URL 換成您的實際訂閱連結
    url: "YOUR_SUBSCRIPTION_URL_HERE"
    path: ./proxies/sub1.yaml
    interval: 3600
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 600

# 2. Rule Providers (規則提供者)
rule-providers:
  AI1_1:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/1664666655/clash/refs/heads/main/list/AI.list"
    path: ./ruleset/AI1_1.list
    interval: 86400
  AI2_1:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/1664666655/clash/refs/heads/main/list/AI2.list"
    path: ./ruleset/AI2_1.list
    interval: 86400
  GitHub_1:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/GitHub/GitHub.list"
    path: ./ruleset/GitHub_1.list
    interval: 86400
  TikTok_1:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/TikTok/TikTok.list"
    path: ./ruleset/TikTok_1.list
    interval: 86400
  Telegram_1:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.list"
    path: ./ruleset/Telegram_1.list
    interval: 86400
  流媒体_1:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/YouTube.list"
    path: ./ruleset/Stream_1_YouTube_liandu.list
    interval: 86400
  流媒体_2:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/YouTube/YouTube.list"
    path: ./ruleset/Stream_2_YouTube_blackmatrix.list
    interval: 86400
  流媒体_3:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/HBO/HBO.list"
    path: ./ruleset/Stream_3_HBO.list
    interval: 86400
  流媒体_4:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Disney/Disney.list"
    path: ./ruleset/Stream_4_Disney.list
    interval: 86400
  流媒体_5:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Netflix/Netflix.list"
    path: ./ruleset/Stream_5_Netflix.list
    interval: 86400
  流媒体_6:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Spotify/Spotify.list"
    path: ./ruleset/Stream_6_Spotify.list
    interval: 86400
  流媒体_7:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/1664666655/clash/refs/heads/main/list/sping.list"
    path: ./ruleset/Stream_7_sping.list
    interval: 86400
  国外_1:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Check.list"
    path: ./ruleset/Global_1_Check_liandu.list
    interval: 86400
  国外_2:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Proxy.list"
    path: ./ruleset/Global_2_Proxy_liandu.list
    interval: 86400
  国外_3:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Global/Global.list"
    path: ./ruleset/Global_3_Global_blackmatrix.list
    interval: 86400

# 3. 策略組 (Proxy Groups)
proxy-groups:
  # --- Select 策略組 ---
  - name: 👽 AI1
    type: select
    proxies:
      - DIRECT
      - 所有-自动
      - 港台日新韩-自动
      - 台日新韩-自动
      - 香港-自动
      - 台湾-自动
      - 日本-自动
      - 新加坡-自动
      - 韩国-自动
      - 美国-自动
      - 其他-自动
      - REJECT
  - name: 👽 AI2
    type: select
    proxies:
      - DIRECT
      - 所有-自动
      - 港台日新韩-自动
      - 台日新韩-自动
      - 香港-自动
      - 台湾-自动
      - 日本-自动
      - 新加坡-自动
      - 韩国-自动
      - 美国-自动
      - 其他-自动
      - REJECT
  - name: 📘 GitHub
    type: select
    proxies:
      - DIRECT
      - 所有-自动
      - 港台日新韩-自动
      - 台日新韩-自动
      - 香港-自动
      - 台湾-自动
      - 日本-自动
      - 新加坡-自动
      - 韩国-自动
      - 美国-自动
      - 其他-自动
      - REJECT
  - name: 👯‍♂️ TikTok
    type: select
    proxies:
      - DIRECT
      - 所有-自动
      - 港台日新韩-自动
      - 台日新韩-自动
      - 香港-自动
      - 台湾-自动
      - 日本-自动
      - 新加坡-自动
      - 韩国-自动
      - 美国-自动
      - 其他-自动
      - REJECT
  - name: 🙋 Telegram
    type: select
    proxies:
      - DIRECT
      - 所有-自动
      - 港台日新韩-自动
      - 台日新韩-自动
      - 香港-自动
      - 台湾-自动
      - 日本-自动
      - 新加坡-自动
      - 韩国-自动
      - 美国-自动
      - 其他-自动
      - REJECT
  - name: 📀 流媒体
    type: select
    proxies:
      - DIRECT
      - 所有-自动
      - 火烧香港-自动
      - 港台日新韩-自动
      - 台日新韩-自动
      - 香港-自动
      - 台湾-自动
      - 日本-自动
      - 新加坡-自动
      - 韩国-自动
      - 美国-自动
      - 其他-自动
      - REJECT
  - name: 🌍 国外
    type: select
    proxies:
      - DIRECT
      - 所有-自动
      - 港台日新韩-自动
      - 火烧台湾-自动
      - 台日新韩-自动
      - 香港-自动
      - 台湾-自动
      - 日本-自动
      - 新加坡-自动
      - 韩国-自动
      - 美国-自动
      - 其他-自动
      - REJECT
  # --- 這個群組本身沒問題，只是不能作為 FINAL 的目標 ---
  - name: ➡️ 国内
    type: select
    proxies:
      - DIRECT
      - 所有-自动
      - 港台日新韩-自动
      - 台日新韩-自动
      - 香港-自动
      - 台湾-自动
      - 日本-自动
      - 新加坡-自动
      - 韩国-自动
      - 美国-自动
      - 其他-自动
      - REJECT

  # --- URL-Test 策略組 ---
  - name: 所有-自动
    type: url-test
    url: 'http://www.gstatic.com/generate_204'
    interval: 60
    tolerance: 150
    use: [SubscriptionNodes]
  - name: 港台日新韩-自动
    type: url-test
    url: 'http://www.gstatic.com/generate_204'
    interval: 60
    tolerance: 150
    use: [SubscriptionNodes]
    # filter: '(广港|广台|广日|广新|广韩|广美|香港|HK|Hong Kong|🇭🇰|HongKong|台湾|TW|Tai Wan|🇹🇼|🇨🇳|TaiWan|Taiwan|日本|JP|川日|东京|大阪|泉日|埼玉|沪日|深日|🇯🇵|Japan|新加坡|SG|坡|狮城|🇸🇬|Singapore|韩国|KR|首尔|春川|🇰🇷|Korea)'
  - name: 台日新韩-自动
    type: url-test
    url: 'http://www.gstatic.com/generate_204'
    interval: 60
    tolerance: 150
    use: [SubscriptionNodes]
    # filter: '(广台|广日|广新|广韩|广美|台湾|TW|Tai Wan|🇹🇼|🇨🇳|TaiWan|Taiwan|日本|JP|川日|东京|大阪|泉日|埼玉|沪日|深日|🇯🇵|Japan|新加坡|SG|坡|狮城|🇸🇬|Singapore|韩国|KR|首尔|春川|🇰🇷|Korea)'
  - name: 火烧香港-自动
    type: url-test
    url: 'http://www.gstatic.com/generate_204'
    interval: 60
    tolerance: 150
    use: [SubscriptionNodes]
    # filter: '火烧 \| 香港 0[1-8]'
  - name: 火烧台湾-自动
    type: url-test
    url: 'http://www.gstatic.com/generate_204'
    interval: 60
    tolerance: 150
    use: [SubscriptionNodes]
    # filter: '火烧 \| 台湾 0[1-5]'
  - name: 香港-自动
    type: url-test
    url: 'http://www.gstatic.com/generate_204'
    interval: 60
    tolerance: 150
    use: [SubscriptionNodes]
    # filter: '(广港|香港|HK|Hong Kong|🇭🇰|HongKong)'
  - name: 台湾-自动
    type: url-test
    url: 'http://www.gstatic.com/generate_204'
    interval: 60
    tolerance: 150
    use: [SubscriptionNodes]
    # filter: '(广台|台湾|台灣|TW|Tai Wan|🇹🇼|🇨🇳|TaiWan|Taiwan)'
  - name: 日本-自动
    type: url-test
    url: 'http://www.gstatic.com/generate_204'
    interval: 60
    tolerance: 150
    use: [SubscriptionNodes]
    # filter: '(广日|日本|JP|川日|东京|大阪|泉日|埼玉|沪日|深日|🇯🇵|Japan)'
  - name: 新加坡-自动
    type: url-test
    url: 'http://www.gstatic.com/generate_204'
    interval: 60
    tolerance: 150
    use: [SubscriptionNodes]
    # filter: '(广新|新加坡|SG|坡|狮城|🇸🇬|Singapore)'
  - name: 韩国-自动
    type: url-test
    url: 'http://www.gstatic.com/generate_204'
    interval: 60
    tolerance: 150
    use: [SubscriptionNodes]
    # filter: '(广韩|韩国|韓國|KR|首尔|春川|🇰🇷|Korea)'
  - name: 美国-自动
    type: url-test
    url: 'http://www.gstatic.com/generate_204'
    interval: 60
    tolerance: 150
    use: [SubscriptionNodes]
    # filter: '(广美|美|US|纽约|波特兰|达拉斯|俄勒|凤凰城|费利蒙|硅谷|拉斯|洛杉|圣何塞|圣克拉|西雅|芝加|🇺🇸|United States)'
  - name: 其他-自动
    type: url-test
    url: 'http://www.gstatic.com/generate_204'
    interval: 60
    tolerance: 150
    use: [SubscriptionNodes]
    # filter: '(波|柬|尼|也|克|比|尔|立|冰|秘|耳|利|埃|希|孟|芬|愛|澳|英|德|南|意|法|拿|墨|印|越|俄|瑞|智|荷|比|巴|沙|班|泰|德|烏|以|Australia|Konghwaguk)'

# 4. 規則 (Rules)
# !!! 注意: 將 FINAL 規則的目標從 "➡️ 国内" 改為 "DIRECT" !!!
rules:
  - RULE-PROVIDER,AI1_1,👽 AI1
  - RULE-PROVIDER,AI2_1,👽 AI2
  - RULE-PROVIDER,GitHub_1,📘 GitHub
  - RULE-PROVIDER,TikTok_1,👯‍♂️ TikTok
  - RULE-PROVIDER,Telegram_1,🙋 Telegram
  - RULE-PROVIDER,流媒体_1,📀 流媒体
  - RULE-PROVIDER,流媒体_2,📀 流媒体
  - RULE-PROVIDER,流媒体_3,📀 流媒体
  - RULE-PROVIDER,流媒体_4,📀 流媒体
  - RULE-PROVIDER,流媒体_5,📀 流媒体
  - RULE-PROVIDER,流媒体_6,📀 流媒体
  - RULE-PROVIDER,流媒体_7,📀 流媒体
  - RULE-PROVIDER,国外_1,🌍 国外
  - RULE-PROVIDER,国外_2,🌍 国外
  - RULE-PROVIDER,国外_3,🌍 国外
  # 將最終規則指向 DIRECT (直連)
  - FINAL,DIRECT
